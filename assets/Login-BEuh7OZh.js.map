{"version":3,"file":"Login-BEuh7OZh.js","sources":["../../src/features/user/Login.jsx","../../src/pages/Login.jsx"],"sourcesContent":["// src/features/user/Login.js\r\nimport { useState } from 'react';\r\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { loginUser } from './userSlice';\r\nimport LandingIntro from './LandingIntro';\r\nimport ErrorText from '../../components/Typography/ErrorText';\r\nimport { saveAuthToken } from '../../app/authUtils';\r\nimport { InputList } from '@/components/InputList';\r\n\r\nfunction Login() {\r\n    const INITIAL_LOGIN_OBJ = {\r\n        email: '',\r\n        password: ''\r\n    };\r\n\r\n    const dispatch = useDispatch();\r\n    const [loading, setLoading] = useState(false);\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n    const [loginObj, setLoginObj] = useState(INITIAL_LOGIN_OBJ);\r\n    const { error } = useSelector((state) => state.user);\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    const [validateFields, setValidateFields] = useState(false);\r\n    \r\n    // Obtener la ruta desde donde vino el usuario (si existe)\r\n    const from = location.state?.from?.pathname || '/app/dashboard';\r\n\r\n    const submitForm = async (e) => {\r\n        e.preventDefault();\r\n        setErrorMessage('');\r\n        setValidateFields(true);\r\n    \r\n        if (loginObj.email === '') {\r\n            return setErrorMessage('El email es requerido!');\r\n        }\r\n        if (loginObj.password === '') {\r\n            return setErrorMessage('La contraseña es requerida!');\r\n        }\r\n    \r\n        setLoading(true);\r\n        try {\r\n            const response = await dispatch(loginUser(loginObj)).unwrap(); // unwrap to handle rejected and fulfilled actions\r\n            if (response?.token) {\r\n                saveAuthToken(response.token);\r\n                setLoading(false);\r\n                navigate(from, { replace: true });\r\n            } else {\r\n                setErrorMessage('Login falló. Por favor, revisa tus credenciales.');\r\n            }\r\n        } catch (e) {\r\n            setErrorMessage(\r\n                e.message === \"Cannot read properties of undefined (reading 'data')\"\r\n                ? \"Error de conexión, contacte al administrador\"\r\n                : e.message\r\n            );\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const updateFormValue = (field, value) => {\r\n        setErrorMessage('');\r\n        setLoginObj((prev) => ({\r\n        ...prev,\r\n        [field]: value,\r\n        }));\r\n    };\r\n\r\n    const infoItems = [\r\n        {\r\n            type: \"input\", \r\n            inputType: \"email\", \r\n            labelTitle: \"Email\", \r\n            name: \"email\", \r\n            placeholder: \"Correo electrónico\", \r\n            value: loginObj.email, \r\n            position: \"top\", \r\n            border: \"bordered\", \r\n            size: \"md\", \r\n            isRequired: true, \r\n        },\r\n        {\r\n            type: \"input\",\r\n            inputType: \"password\",\r\n            labelTitle: \"Contraseña\",\r\n            name: \"password\",\r\n            placeholder: \"Contraseña\",\r\n            value: loginObj.password,\r\n            position: \"top\",\r\n            border: \"bordered\",\r\n            size: \"md\",\r\n            isRequired: true,\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-base-200 flex items-center\">\r\n            <div className=\"card mx-auto w-full max-w-5xl shadow-xl\">\r\n                <div className='w-full sm:hidden'>\r\n                    <img \r\n                        src=\"/Login-01.png\" \r\n                        alt=\"logo\" \r\n                        className=\"object-cover w-full\" \r\n                    />\r\n                </div>\r\n                <div className=\"grid md:grid-cols-2 grid-cols-1 bg-base-100 rounded-xl\">\r\n                    <div>\r\n                        <LandingIntro />\r\n                    </div>\r\n                    <div className=\"py-12 px-10 my-auto\">\r\n                        <h2 className=\"text-2xl font-semibold mb-2 text-center\">Acceso</h2>\r\n                        <form onSubmit={submitForm}>\r\n                            <div className=\"mb-4 space-y-2\">\r\n                            <InputList\r\n                                infoItems={infoItems}\r\n                                updateFormValue={updateFormValue}\r\n                                fieldValues={loginObj}\r\n                                shouldValidate={validateFields}\r\n                            />\r\n                            </div>\r\n                            <div className=\"text-right text-primary\">\r\n                                <Link to=\"/forgot-password\">\r\n                                    <span className=\"text-sm inline-block hover:text-primary hover:underline hover:cursor-pointer transition duration-200\">\r\n                                        Olvidó la contraseña?\r\n                                    </span>\r\n                                </Link>\r\n                            </div>\r\n                            <ErrorText styleClass=\"mt-8\">{errorMessage || error?.message}</ErrorText>\r\n                            <button type=\"submit\" className={`btn mt-2 w-full btn-primary${loading ? ' loading' : ''}`}>\r\n                                Acceder\r\n                            </button>\r\n                            \r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Login;\r\n","import {useState, useRef} from 'react'\nimport {Link} from 'react-router-dom'\nimport Login from '../features/user/Login'\n\nfunction ExternalPage(){\n\n\n    return(\n        <div className=\"\">\n                <Login />\n        </div>\n    )\n}\n\nexport default ExternalPage"],"names":["Login","INITIAL_LOGIN_OBJ","dispatch","useDispatch","loading","setLoading","useState","errorMessage","setErrorMessage","loginObj","setLoginObj","error","useSelector","state","navigate","useNavigate","location","useLocation","validateFields","setValidateFields","from","_b","_a","submitForm","e","response","loginUser","saveAuthToken","updateFormValue","field","value","prev","infoItems","jsxs","jsx","LandingIntro","InputList","Link","ErrorText","ExternalPage"],"mappings":"uOAUA,SAASA,GAAQ,SACb,MAAMC,EAAoB,CACtB,MAAO,GACP,SAAU,EAAA,EAGRC,EAAWC,EAAA,EACX,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAK,EACtC,CAACC,EAAcC,CAAe,EAAIF,EAAAA,SAAS,EAAE,EAC7C,CAACG,EAAUC,CAAW,EAAIJ,EAAAA,SAASL,CAAiB,EACpD,CAAE,MAAAU,CAAA,EAAUC,EAAaC,GAAUA,EAAM,IAAI,EAC7CC,EAAWC,EAAA,EACXC,EAAWC,EAAA,EACX,CAACC,EAAgBC,CAAiB,EAAIb,EAAAA,SAAS,EAAK,EAGpDc,IAAOC,GAAAC,EAAAN,EAAS,QAAT,YAAAM,EAAgB,OAAhB,YAAAD,EAAsB,WAAY,iBAEzCE,EAAa,MAAOC,GAAM,CAK5B,GAJAA,EAAE,eAAA,EACFhB,EAAgB,EAAE,EAClBW,EAAkB,EAAI,EAElBV,EAAS,QAAU,GACnB,OAAOD,EAAgB,wBAAwB,EAEnD,GAAIC,EAAS,WAAa,GACtB,OAAOD,EAAgB,6BAA6B,EAGxDH,EAAW,EAAI,EACf,GAAI,CACA,MAAMoB,EAAW,MAAMvB,EAASwB,EAAUjB,CAAQ,CAAC,EAAE,OAAA,EACjDgB,GAAA,MAAAA,EAAU,OACVE,EAAcF,EAAS,KAAK,EAC5BpB,EAAW,EAAK,EAChBS,EAASM,EAAM,CAAE,QAAS,EAAA,CAAM,GAEhCZ,EAAgB,kDAAkD,CACtE,OACKgB,EAAG,CACRhB,EACIgB,EAAE,UAAY,uDACZ,+CACAA,EAAE,OAAA,CACR,QACJ,CACInB,EAAW,EAAK,CAAA,CACpB,EAGEuB,EAAkB,CAACC,EAAOC,IAAU,CACtCtB,EAAgB,EAAE,EAClBE,EAAaqB,IAAU,CACvB,GAAGA,EACH,CAACF,CAAK,EAAGC,CAAA,EACP,CAAA,EAGAE,EAAY,CACd,CACI,KAAM,QACN,UAAW,QACX,WAAY,QACZ,KAAM,QACN,YAAa,qBACb,MAAOvB,EAAS,MAChB,SAAU,MACV,OAAQ,WACR,KAAM,KACN,WAAY,EAAA,EAEhB,CACI,KAAM,QACN,UAAW,WACX,WAAY,aACZ,KAAM,WACN,YAAa,aACb,MAAOA,EAAS,SAChB,SAAU,MACV,OAAQ,WACR,KAAM,KACN,WAAY,EAAA,CAChB,EAGJ,aACK,MAAA,CAAI,UAAU,6CACX,SAAAwB,EAAAA,KAAC,MAAA,CAAI,UAAU,0CACX,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,mBACX,SAAAA,EAAAA,IAAC,MAAA,CACG,IAAI,gBACJ,IAAI,OACJ,UAAU,qBAAA,CAAA,EAElB,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,yDACX,SAAA,CAAAC,EAAAA,IAAC,MAAA,CACG,SAAAA,EAAAA,IAACC,EAAA,CAAA,CAAa,EAClB,EACAF,EAAAA,KAAC,MAAA,CAAI,UAAU,sBACX,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,0CAA0C,SAAA,SAAM,EAC9DD,EAAAA,KAAC,OAAA,CAAK,SAAUV,EACZ,SAAA,CAAAW,EAAAA,IAAC,MAAA,CAAI,UAAU,iBACf,SAAAA,EAAAA,IAACE,EAAA,CACG,UAAAJ,EACA,gBAAAJ,EACA,YAAanB,EACb,eAAgBS,CAAA,CAAA,EAEpB,EACAgB,MAAC,MAAA,CAAI,UAAU,0BACX,eAACG,EAAA,CAAK,GAAG,mBACL,SAAAH,EAAAA,IAAC,OAAA,CAAK,UAAU,uGAAuG,SAAA,uBAAA,CAEvH,EACJ,EACJ,QACCI,EAAA,CAAU,WAAW,OAAQ,SAAA/B,IAAgBI,GAAA,YAAAA,EAAO,SAAQ,EAC7DuB,EAAAA,IAAC,SAAA,CAAO,KAAK,SAAS,UAAW,8BAA8B9B,EAAU,WAAa,EAAE,GAAI,SAAA,SAAA,CAE5F,CAAA,CAAA,CAEJ,CAAA,CAAA,CACJ,CAAA,CAAA,CACJ,CAAA,CAAA,CACJ,CAAA,CACJ,CAER,CCvIA,SAASmC,GAAc,CAGnB,aACK,MAAA,CAAI,UAAU,GACP,SAAAL,MAAClC,IAAM,EACf,CAER"}